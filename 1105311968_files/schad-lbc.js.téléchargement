/*
 SCHAD Renderer - 2e3ad3d
*/
(function(){function g(a,b){if(!(this instanceof g))return new g(a,b);var c=b.template&&"string"!==typeof b.template;this.C=a;c?this.s=new m(this,b):this.s=new e(this,b);this.b="https://mobile.adnxs.com/mob";this.container=b.container;this.count=b.count||1;this.appnexusMemberId=b.appnexusMemberId||"3296";this.i=[];this.geoThrottle=void 0!==b.geoThrottle?b.geoThrottle:1;this.targeting=b.targeting||{};this.onEmptyAd=b.onEmptyAd;this.defaults=b.defaults;this.market=b.market;this.g=new p;this.adFormat=
b.adFormat&&[].concat(b.adFormat);this.I(this.b);if(!this.container&&!c)throw Error("No container");r("schadPreview")||b.debug?this.o=new t:this.o=new k(this);Math.random()<this.geoThrottle?this.F(this.m.bind(this)):this.m()}function p(){}function u(a){var b={},c;for(c in a)if(a.hasOwnProperty(c))if("object"==typeof a[c]){var d=u(a[c]),l;for(l in d)d.hasOwnProperty(l)&&(b[c+"."+l]=d[l])}else b[c]=a[c];return b}function e(a,b){this.b=b.template?"":e.c;this.a=a;this.template=b.template||e.b;this.container=
b.container}function m(a,b){var c=b.template.stream+" "+b.template.item;this.a=a;this.template=b.template;this.stream=document.querySelector(this.template.stream);this.b=document.querySelector(c);this.c=document.querySelectorAll(c+":nth-child("+this.template.position+" )");if(!this.stream)throw Error("The stream couldnt be found on the dom with selector "+this.template.stream);if(!this.b)throw Error("The element to clone couldnt be found on the dom with selector "+c);}function n(a){a=a+"";for(var b=
"",c=0;c<a.length;c++)"<"===a[c]?b+="&lt;":">"===a[c]?b+="&gt;":"'"===a[c]?b+="&#39;":'"'===a[c]?b+="&quot;":b+=a[c];return b}function t(){}function k(a){this.c=a.b;this.appnexusMemberId=a.appnexusMemberId;this.b=a.C;this.g=a.g;this.defaults=a.defaults;this.i=[]}function h(a,b){var c=b||{};this.title=a.title;this.description=a.description;this.cta=a.cta;this.url=a.url;this.encodedUrl=a.encodedUrl||window.encodeURI(a.url);this.l=a.click_trackers||[];this.u=a.impression_trackers||[];this.image=a.image;
this.logo=a.logo;this.price=a.price;this.f=a.f;this.g=c.g;this.a()}function v(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]})}function q(a){function b(a){return String(a).replace(e,encodeURIComponent).replace(/ /g,"+").replace(/[!'()~\*]/g,function(a){return"%"+a.charCodeAt().toString(16).slice(-2).toUpperCase()})}function c(a){return a.filter(function(a){return a}).join("&")}function d(a,b){return c(Object.keys(b).map(function(c){return f(a+"["+c+"]",b[c])}))}function l(a,d){return d.length?
c(d.map(function(b){return f(a,b)})):b(a)}function f(a,c){var f=typeof c,e=null;c===e?e=b(a)+"="+e:/string|number|boolean/.test(f)?e=b(a)+"="+b(c):Array.isArray(c)?e=l(a,c):"object"===f&&(e=d(a,c));return e}var e=RegExp('(?:[\x00-\u001f"-&+-}\u007f-\ud7ff\ue000-\uffff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff])',"g");return a&&c(Object.keys(a).map(function(b){return f(b,a[b])}))}function r(a){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+
encodeURIComponent(a).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||void 0}h.b=function(a,b){var c;if(!b)return null;for(var d=b.length-1;0<=d;d--)if(c=b[d],c.label===a)return c;return!1};h.c=function(a){return a.replace(/https?:\/\/(www.)?/i,"").split("/")[0].split("?")[0].split("#")[0]};h.a=function(a){var b=q({height:500,width:500});return a+(-1!==a.indexOf("?")?"&":"?")+b};h.prototype.a=function(){this.f&&this.g&&(this.u.push(this.g.B(this)),this.l.push(this.g.A(this)))};
h.prototype.h=function(a){return a.item(this)};k.prototype.a=function(a,b,c,d){c={cs:"1",size:"1x1","aa-sch-ssa-native-ad":!0,member:this.appnexusMemberId,inv_code:this.b,loc:c};var l={};v(l,b);v(l,c);b=q(l);b=this.c+"?"+b;for(--a;0<=a;a--)g.a(b,{withCredentials:!0},this.j.bind(this,d,a))};k.prototype.j=function(a,b,c,d){c||"ok"!==d.status&&"no_bid"!==d.status||1!==d.version||(b=d["native"]||[],a(b.map(function(a){return new h(k.a(a,this.defaults),{g:this.g})}.bind(this))))};k.a=function(a,b){var c=
a.custom,d=window.decodeURI(a.click_url),e,f=null,g=!1,k=h.b("default",a.main_media),n=h.b("icon",a.main_media),m;n?f=n.url:a.icon_img_url&&(f=a.icon_img_url);f?f=h.a(f):b&&b.logo&&(f=b.logo);k&&(m=k.url);m?k=h.a(m):b&&b.image&&(k=b.image);c&&c.destination_label?e=c.destination_label:e=h.c(a.click_url);c&&c.meta_data&&(g=JSON.parse(atob(c.meta_data)));return{title:a.title,cta:e,description:a.full_text||a.description,full_text:a.full_text,url:d,click_trackers:a.click_trackers,impression_trackers:a.impression_trackers,
f:g,image:k,logo:f,price:c?c.price:null}};t.prototype.a=function(a,b,c,d){b=[];for(--a;0<=a;a--)b.push(new h(k.a({type:"in-feed-standard",title:"Schibsted media group",description:"Schibsted Media Group is a Norwegian media group with operations in 29 countries and has headquarters in Oslo, Norway.",full_text:"Schibsted Media Group is a Norwegian media group with operations in 29 countries and has headquarters in Oslo, Norway.",icon_img_url:"https://d23m3izcfffoa9.cloudfront.net/img/logos/schibsted-745e8e00.svg",
main_media:[{label:"default",width:1E3,height:750,url:"https://d23m3izcfffoa9.cloudfront.net/img/logos/schibsted-745e8e00.svg"}],cta:"download",click_trackers:[],impression_trackers:[],click_url:"http://schibsted.com",custom:{destination_label:"schibsted.com",meta_data:"eyJjb250ZW50SWQiOiItMSIsImNvbnRlbnRTb3VyY2UiOiJCT09LSU5HX0FQSSIsImFkdmVydGlzZXJJZCI6Ii0yIiwiY2FtcGFpZ25JZCI6Ii0zIn0="}})));d(b)};m.prototype.h=function(a){this.list(a.i)};m.prototype.list=function(a){for(var b=0;b<a.length&&!(b>=this.c.length);b++)this.stream.insertBefore(a[b].h(this),
this.c[b]),this.a.j(a[b])};m.prototype.item=function(a){var b,c=this.b.cloneNode(!0);c.className+=" schad";this.j(c,a,this.template);b=c.querySelectorAll(this.template.links);for(var d=0;d<b.length;d++)b[d].setAttribute("href",n(a.url));this.a.c(b,a);(b=c.querySelector(this.template.image))&&a.image?(b.setAttribute("src",n(a.image)),b.removeAttribute("srcset")):b&&b.parentNode.removeChild(b);(b=c.querySelector(this.template.logo))&&a.logo?(b.setAttribute("src",n(a.logo)),b.removeAttribute("srcset")):
b&&b.parentNode.removeChild(b);a=this.template.hiddenNodes?c.querySelectorAll(this.template.hiddenNodes):[];for(b=0;b<a.length;b++)a[b].parentNode.removeChild(a[b]);return c};m.prototype.j=function(a,b,c){var d=["title","description","cta","price"],e,f,g;for(f=0;f<d.length;f++)for(e=a.querySelectorAll(c[d[f]]),g=0;g<e.length;g++)e[g].innerHTML=n(b[d[f]])};e.a="schadAdRendering";e.b="<a href='_url' class='schad-ad' target='_blank'><span class='schad-title'>_title</span><span class='schad-description'>_description</span><span class='schad-link'>_cta</span></a>";
e.c="#"+e.a+" .schad{margin:10px 0 0 0;font-family:Arial,sans-serif;padding:0;font-size:12px;line-height:16px}#"+e.a+" .schad-ad-outer{padding-left:20px}#"+e.a+" .schad-ad-outer:first-child{padding-left:0}#"+e.a+" .schad-ad{min-height:121px;padding:12px;border:1px solid #ccc;background:white;width:auto}#"+e.a+" a{text-decoration:none;color:#1a1a1a;display:block;font-weight: normal;}#"+e.a+" a:hover{text-decoration:none}#"+e.a+" .schad-title{display:block;font-weight:bold;margin-bottom:5px;text-transform:uppercase;line-height:12px}#"+
e.a+" .schad-description{display:block;margin-bottom:10px;}#"+e.a+" .schad-link{display:block;color:#369;line-height:12px}";e.prototype.h=function(a){var b=this.c(),c=document.createElement("style");a=this.list(a.i);c.setAttribute("type","text/css");c.styleSheet?(b.appendChild(c),c.styleSheet.cssText=this.b):(c.innerHTML=this.b,b.appendChild(c));b.appendChild(a)};e.prototype.list=function(a){var b=document.createElement("div");b.className="schad";for(var c=0;c<a.length;c++)b.appendChild(a[c].h(this));
return b};e.prototype.item=function(a){for(var b="title cta description encodedUrl logo price image".split(" "),c={},d=0;d<b.length;d++)c["_"+b[d]]=n(a[b[d]]);c._url=n(a.url);b=new RegExp(Object.keys(c).join("|"),"g");d=document.createElement("div");d.className="schad-ad-outer";d.innerHTML+=this.template.replace(b,function(a){return c[a]});this.a.c(d.querySelectorAll("a"),a);this.a.j(a);return d};e.prototype.c=function(){var a=document.createElement("div");a.setAttribute("id",e.a);this.container.appendChild(a);
return a};var w={w:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}};p.prototype.B=function(a){return this.a({schema:"http://schema.schibsted.com/events/blender-event.json/1.json#","@id":w.w(),"@type":"Blender",action:"Impression",published:(new Date).toISOString(),object:{"@type":"BlenderContent","@id":"urn:schibsted.com:blender",cid:a.f.contentId,cs:a.f.contentSource,cnid:a.f.campaignId,advid:a.f.advertiserId,
pub:null,sid:null,uid:null,test:!1},provider:{"@id":"urn:schibsted.com:blender"}})};p.prototype.A=function(a){return this.a({schema:"http://schema.schibsted.com/events/blender-event.json/1.json#","@id":w.w(),"@type":"Blender",action:"Click",published:(new Date).toISOString(),object:{"@type":"BlenderContent","@id":"urn:schibsted.com:blender",cid:a.f.contentId,cs:a.f.contentSource,cnid:a.f.campaignId,advid:a.f.advertiserId,pub:null,sid:null,uid:null,test:!1},provider:{"@id":"urn:schibsted.com:blender"}})};
p.prototype.a=function(a){return"//collector.schibsted.io/img?"+q(u(a))};g.a=function(a,b,c){var d=new window.XMLHttpRequest,e=!1;"function"===typeof b&&(c=b,b={});b=b||{};d.onreadystatechange=function(){var a;if(4===d.readyState)if(200===d.status){if(!e){e=!0;try{a=JSON.parse(d.responseText)}catch(b){return console.error("[schad] Ad rendering failed: error parsing response")}c&&c(null,a)}}else c&&c(Error("Non-200 response"))};d.open("GET",a);d.withCredentials=b.withCredentials;d.send()};g.prototype.m=
function(){this.market&&(this.market=[].concat(this.market),this.targeting["kw_aa-sch-ssa-market"]=this.market);this.adFormat&&(this.targeting["kw_aa-sch-ssa-format"]=this.adFormat);this.o.a(this.count,this.targeting,this.a,this.G.bind(this))};g.prototype.G=function(a){0===a.length&&this.onEmptyAd?(a=this.onEmptyAd())&&this.i.push(new h(a,{g:this.g})):this.i=this.i.concat(a);this.h(this.s)};g.prototype.h=function(a){return a.h(this)};g.prototype.I=function(a){var b=document.createElement("link");
b.rel="preconnect";b.href=a;document.head.appendChild(b)};g.prototype.v=function(a){for(var b,c=0;c<a.length;c++)b=new Image,b.src=a[c]};g.prototype.j=function(a){this.v(a.u)};g.prototype.c=function(a,b){for(var c=0;c<a.length;c++)a[c].addEventListener("click",this.H.bind(this,b))};g.prototype.H=function(a){this.v(a.l)};g.prototype.F=function(a){var b=window.sessionStorage||{},c=window.localStorage||window.sessionStorage||{};(this.a=c.schadll=c.schadll||b.schadll||"")?a():(this.D=setTimeout(a,500),
g.a("https://loc.schibsted.io",function(b,e){e&&(this.a=c.schadll=e);clearTimeout(this.D);a()}.bind(this)))};(function(){if(!(!r("schad")&&1<=Math.random()||!document.querySelector)){for(var a=window.schad&&window.schad.q||[],b=[],c,d=document.querySelectorAll(".schad"),e,f;a.length;){c=a.shift();c=c[0];f=c[1]||{};if((e=f.container)&&"object"!==typeof e)throw Error("Passed container must be a dom node.");f.container=e||d[b.length];b.push(new g(c[0],f))}window.schad=g}})()})();
